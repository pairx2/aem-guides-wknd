<VirtualHost *:80>
    ServerName {{name}}
    {{#if f7}}
    ServerAlias f7aya7rugada.{{name}}
    {{/if}}
    {{#if www}}
    ServerAlias www.{{name}}
    {{/if}}
    ServerAlias staging.{{name}}
{{#if isCloudSubdomainRequiredOnUat}}
    ServerAlias uat.cloud.{{name}}
{{else}}
    ServerAlias uat.{{name}}
{{/if}}
{{#if isCloudSubdomainRequired}}
    {{#ifEquals name "abbott.com"}}
        ServerAlias dev.aem.{{name}}
        ServerAlias dev2.aem.{{name}}
        ServerAlias qa.aem.{{name}}
        ServerAlias qa2.aem.{{name}}
    {{/ifEquals}}
    {{#ifNotEquals name "abbott.com"}}
        ServerAlias dev.cloud.{{name}}
        ServerAlias dev2.cloud.{{name}}
        ServerAlias qa.cloud.{{name}}
        ServerAlias qa2.cloud.{{name}}
    {{/ifNotEquals}}
    
{{else}}
    ServerAlias dev.{{name}}
    ServerAlias dev2.{{name}}
	ServerAlias devsbx.{{name}}
    ServerAlias qa.{{name}}
    ServerAlias qa2.{{name}}
    {{#ifEquals name "nic.services.abbott"}}
        ServerAlias nic.abbott
    {{/ifEquals}}
{{/if}}
    ServerAlias dev2preview.{{name}}
    ServerAlias preview.{{name}}
    ServerAlias local.{{name}}
	
	#Added ServerAlias for Adobe scan tool
    ServerAlias    "*.local"


    DocumentRoot "${DOCROOT}"

    # Add header breadcrumbs for help in troubleshooting
    <IfModule mod_headers.c>
        Header add X-Original-Request-Host "expr=%{req:X-Forwarded-Host}"
        Header add X-Vhost "{{name}}"
        
        {{#ifEquals name "abbottstore.com"}}
        SetEnvIf Origin "http(s)?://?(dev2.abbottstore.com|dev.abbottstore.com|qa2.abbottstore.com|qa.abbottstore.com|uat.abbottstore.com|staging.abbottstore.com|abbottstore.com|dev2-secure.abbottstore.com|dev-secure.abbottstore.com|qa2-secure.abbottstore.com|qa-secure.abbottstore.com|uat-secure.abbottstore.com|staging-secure.abbottstore.com|secure.abbottstore.com|frh-q.abbott.com|frh.abbott.com)$" AccessControlAllowOrigin=$0
		Header add Access-Control-Allow-Origin %{AccessControlAllowOrigin}e env=AccessControlAllowOrigin
        {{/ifEquals}}
        {{#ifEquals name "glucernastore.com"}}
		SetEnvIf Origin "http(s)?://?(dev2.glucernastore.com|dev.glucernastore.com|qa2.glucernastore.com|qa.glucernastore.com|uat.glucernastore.com|staging.glucernastore.com|glucernastore.com|dev2-secure.glucernastore.com|dev-secure.glucernastore.com|qa2-secure.glucernastore.com|qa-secure.glucernastore.com|uat-secure.glucernastore.com|staging-secure.glucernastore.com|secure.glucernastore.com|frh-q.abbott.com|frh.abbott.com)$" AccessControlAllowOrigin=$0
		Header add Access-Control-Allow-Origin %{AccessControlAllowOrigin}e env=AccessControlAllowOrigin        
        {{/ifEquals}}
        {{#ifEquals name "similac.com"}}
		SetEnvIf Origin "http(s)?://?(dev2.similac.com|dev.similac.com|qa2.similac.com|qa.similac.com|uat.similac.com|staging.similac.com|www.similac.com|dev2-secure.similac.com|dev-secure.similac.com|qa2-secure.similac.com|qa-secure.similac.com|uat-secure.similac.com|staging-secure.similac.com|secure.similac.com)$" AccessControlAllowOrigin=$0
		Header add Access-Control-Allow-Origin %{AccessControlAllowOrigin}e env=AccessControlAllowOrigin
        {{/ifEquals}}
        {{#ifEquals name "cms.services.abbott"}}
        SetEnvIf Origin "http(s)?://(consumer.dev.colibri.abbott.com|consumer.qa.colibri.abbott.com|consumer.stg.colibri.abbott.com|consumer.int.colibri.abbott.com|consumer.prd.colibri.abbott.com|localhost:3000|dev.knowme.com|int.knowme.com|qa.knowme.com|stg.knowme.com|www.knowme.com)$" AccessControlAllowOrigin=$0
        # Set Access-Control-Allow-Origin if the Origin is allowd
        Header set Access-Control-Allow-Origin %{AccessControlAllowOrigin}e env=AccessControlAllowOrigin
        Header merge Vary Origin
        {{/ifEquals}}
        {{#ifEquals name "contigo.abbott"}}
        SetEnvIf Origin "http(s)?://?(auth-sbx-anlatam.abbott.com|auth-eu-dev.abbott.com|auth-eu-qa.abbott.com)$" AccessControlAllowOrigin=$0
		Header add Access-Control-Allow-Origin %{AccessControlAllowOrigin}e env=AccessControlAllowOrigin
        {{/ifEquals}}

        {{#ifNotEquals name "freestylelibre.de"}}   
        # Add cookie for use in CDN switch
        Header append Set-Cookie "v=v2;path=/;HttpOnly;Secure"
        {{/ifNotEquals}}
        
    </IfModule>

    <Directory />
        <IfModule disp_apache2.c>
            # Some items cache with the wrong mime type
            # Use this option to use the name to auto-detect mime types when cached improperly
            ModMimeUsePathInfo On
            # Use this option to avoid cache poisioning
            # Sling will return /content/image.jpg as well as /content/image.jpg/ but apache can't search /content/image.jpg/ as a file
            # Apache will treat that like a directory.  This assures the last slash is never stored in cache
            DirectorySlash Off
            # Enable the dispatcher file handler for apache to fetch files from AEM
            SetHandler dispatcher-handler
        </IfModule>
        Options FollowSymLinks
        AllowOverride None
        # Insert filter
        SetOutputFilter DEFLATE
        # Don't compress images
        SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png)$ no-gzip dont-vary
        # Make sure proxies don't deliver the wrong content
        # Commenting this after suggestion from Adobe. Refer ECOMM-16191
        # Header append Vary User-Agent env=!dont-vary
        # Adding security headers
        # Prevent clickjacking
        Header always append X-Frame-Options SAMEORIGIN
        # Permissions-Policy
        Header set Permissions-Policy "microphone=(),camera=(self)"
		{{#ifEquals name "family.abbott"}}
		Header set Permissions-Policy "microphone=(),camera=(self 'https://www.app.trak.es' 'https://app.trak.es')"
		{{/ifEquals}}
       # Referrer-Policy
       Header always set Referrer-Policy "strict-origin-when-cross-origin"
		#CSP Referrer-Policy
		#Header set Content-Security-Policy-Report-Only "default-src 'self';"
		{{#if cspHeaders}}
        {{{cspHeaders}}}
        {{else}}
        Header set Content-Security-Policy-Report-Only "default-src 'self' https: ; script-src 'self' https: 'unsafe-inline' 'unsafe-eval' ; script-src-elem 'self' https: 'unsafe-inline' 'unsafe-eval' ; style-src 'self' https: 'unsafe-inline' 'unsafe-eval'; img-src 'self' https: data: ; form-action 'self' https: 'unsafe-inline' 'unsafe-eval';"
        {{/if}}
    </Directory>
    <Directory "${DOCROOT}">
        AllowOverride None
        Require all granted
    </Directory>
    <IfModule disp_apache2.c>
        # Enabled to allow rewrites to take affect and not be ignored by the dispatcher module
        DispatcherUseProcessedURL On
        # Default setting (0) to allow all errors to come from the aem instance
        DispatcherPassError 1
    </IfModule>

    <IfModule mod_rewrite.c>
        RewriteEngine	on
        Include conf.d/rewrites/rewrite.rules
		{{#ifEquals name "abbottnutrition.com"}}
		    ##Rule to ignore case
            RewriteMap lc int:tolower
			#RewriteCond %{REQUEST_URI} ^(.*)[A-Z]+(.*)$
			#RewriteCond %{REQUEST_URI} !.*\..*$
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteCond %{REQUEST_FILENAME} !-d
            RewriteCond %{REQUEST_URI} [A-Z]
			RewriteCond %{REQUEST_URI} !^/content/dam
			RewriteCond %{REQUEST_URI} !^/etc
            RewriteCond %{HTTPS} off
			RewriteRule /(.*) https://%{SERVER_NAME}/${lc:$1} [R=301,L] 		
        {{/ifEquals}}
		
		# custom rewrites        
		{{{rewrites}}}

	# Allow caching of persisted queries
	RewriteCond %{REQUEST_URI} ^/graphql/execute.json
	RewriteRule ^/(.*)$ /$1;.json [PT,L]

        {{#unless isExtensionless}}
        {{#unless isExtensionlessWithoutSlash}}
	    # Add .html extension when extension is missing from request
		RewriteCond %{REQUEST_FILENAME} !-d
        RewriteCond %{REQUEST_URI} !^/bin
		{{#ifEquals name "vascular.eifu.abbott"}}
		RewriteCond %{REQUEST_URI} !^/content/dam/av/eifu/contact-us-fragments
		{{/ifEquals}}
		{{#ifEquals name "globalpointofcare.eifu.abbott"}}
		RewriteCond %{REQUEST_URI} !^/content/dam/ardx/eifu/contact-us-fragments
		{{/ifEquals}}
        RewriteRule ^([^.]*[^./])$ $1.html [R=301,L]
        {{/unless}}
        {{/unless}}

		{{#if siteInDAM}}
        # Content-Disposition Header
        <LocationMatch "^\/content\/dam.*\.(pdf|jpe?g|png|gif|txt|xml|html).*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition inline
	    </LocationMatch>
		{{else}}
		{{#ifNotEquals name "provider.freestyle.abbott"}}
		<LocationMatch "^\/content\/dam.*\.(pdf|jpe?g|png|gif|txt|xml|json).*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition inline
	    </LocationMatch>
		{{/ifNotEquals}}
		{{#ifEquals name "provider.freestyle.abbott"}}
		<LocationMatch "^\/content\/dam.*\.(pdf|jpe?g|png|gif|txt|xml|json).*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition inline
	    </LocationMatch>
		<LocationMatch "^\/content\/dam.*\.*.coredownload.*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition attachment
	    </LocationMatch>
		{{/ifEquals}}

		{{#ifEquals name "cardiovascular.abbott"}}
		<LocationMatch "^\/content\/dam\/cv\/cardiovascular\/us\/en\/education-training.*\.(html|js|css|xml|woff|png|jpg|mp3|json|mp4).*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition inline
	    </LocationMatch>
		{{/ifEquals}}
        {{#ifEquals name "freestyle.abbott"}}
		<LocationMatch "^\/.*\/FrizbitServiceWorker\.(js).*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition inline
	    </LocationMatch>
		{{/ifEquals}}
		{{#ifEquals name "globalpointofcare.eifu.abbott"}}
		<LocationMatch "^\/content\/dam.*\.(pdf|jpe?g|png|gif|txt|xml|html).*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition inline
	    </LocationMatch>
		{{/ifEquals}}
		{{#ifEquals name "vascular.eifu.abbott"}}
		<LocationMatch "^\/content\/dam.*\.(pdf|jpe?g|png|gif|txt|xml|html).*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition inline
	    </LocationMatch>
		{{/ifEquals}}
        {{#ifEquals name "manuals.eifu.abbott"}}
		<LocationMatch "^\/content\/dam.*\.(pdf|jpe?g|png|gif|txt|xml|html).*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition inline
	    </LocationMatch>
		{{/ifEquals}}
		{{#ifEquals name "freestyle.abbott"}}
		<LocationMatch "^\/content\/dam.*\.(txt|html).*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition inline
	    </LocationMatch>
		{{/ifEquals}}
		{{#ifNotEquals name "provider.freestyle.abbott"}}
        {{#ifNotEquals name "cardiovascular.abbott"}}
		{{#ifNotEquals name "globalpointofcare.eifu.abbott"}}
		{{#ifNotEquals name "vascular.eifu.abbott"}}
		<LocationMatch "^\/content\/dam.*\.(pdf|jpe?g|png|gif|txt|xml|json).*">
		    Header unset "Content-Disposition"
		    Header set Content-Disposition inline
	    </LocationMatch>
		{{/ifNotEquals}}
		{{/ifNotEquals}}
        {{/ifNotEquals}}
        {{/ifNotEquals}}
		
		{{/if}}
        RewriteRule ^/favicon.ico$ {{faviconPath}} [PT,NC,L]
        RewriteRule ^/apple-touch-icon(.*)$ {{appleIconPath}}/apple-touch-icon$1 [PT,NC,L]
		{{#ifEquals name "freestyle.abbott"}}
		RewriteRule ^/.well-known/apple-developer-merchantid-domain-association /content/dam/adc/freestyle/applepay/apple-developer-merchantid-domain-association  [PT,NC,L]
		RewriteRule ^/.well-known/apple-developer-merchantid-domain-association.txt /content/dam/adc/freestyle/applepay/apple-developer-merchantid-domain-association.txt  [PT,NC,L]
        {{/ifEquals}}
		
		{{#if isMapEnabled}}
			# rewrites for robots.txt, sitemap.xml and faqsitemap.xml
			{{#if siteInDAM}}
			RewriteRule ^/robots.txt$ /content/{{division}}/{{site}}/seo/robots.txt [PT,NC,L]
			{{else}}
                {{#if division}}
                    {{#if primaryMarket}}
			RewriteRule ^/robots.txt$ /content/dam/{{division}}/{{site}}/seo/robots.txt [PT,NC,L]
                    {{/if}}
                {{else}}
            RewriteRule ^/robots.txt$ /content/dam/{{site}}/seo/robots.txt [PT,NC,L]
                {{/if}}
			{{/if}}
			{{#if multiMarket}}
				{{#if sitemapAtRoot}}
			## Site {{site}} Sitemap 
			RewriteRule ^/sitemap.xml$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}.sitemap.xml [PT,NC,L]
            RewriteRule ^/faqsitemap.xml$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}.faqsitemap.xml [PT,NC,L]
				{{else}}
				   {{#each markets}}
						{{#each languages}}
			## Country/Language {{../path}}/{{this}} Sitemap 
			RewriteRule ^/{{../path}}/{{this}}/sitemap.xml$ /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}.sitemap.xml [PT,NC,L]
            RewriteRule ^/{{../path}}/{{this}}/faqsitemap.xml$ /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}.faqsitemap.xml [PT,NC,L]
						{{/each}}
					{{/each}}
				{{/if}}
			{{else}}
					{{#if multiLanguage}}
						{{#each markets}}
							{{#each languages}}
			## Country-Language {{this}} Sitemap 
			RewriteRule ^/{{this}}/sitemap.xml$ /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}.sitemap.xml [PT,NC,L]
            RewriteRule ^/{{this}}/faqsitemap.xml$ /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}.faqsitemap.xml [PT,NC,L]
							{{/each}}
						{{/each}}
					{{else}}
			RewriteRule ^/sitemap.xml$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}.sitemap.xml [PT,NC,L]
            RewriteRule ^/faqsitemap.xml$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}.faqsitemap.xml [PT,NC,L]
					{{/if}}
			{{/if}}
            {{#ifEquals name "similac.com"}}
            RewriteRule ^/sitemap.xml$ /content/{{division}}/{{site}}/.sitemap.xml [PT,NC,L]
            RewriteRule ^/faqsitemap.xml$ /content/{{division}}/{{site}}/.faqsitemap.xml [PT,NC,L]
            {{/ifEquals}}

			{{#each geolocation}}
			## Country {{country}} Geolocation Header 
			RewriteCond %{HTTP:CloudFront-Viewer-Country} {{country}} [NC]
			RewriteRule ^/$ {{path}} [R=301,L]
			{{/each}}
       
			## Rewrites for PWA JS to abbott-platform path
			{{#if isExtensionlessWithoutSlash}}
				RewriteRule ^/abbott.sw.js$ /content/abbott-platform/scripts/pwa/abbott.sw.js [PT,L]
				RewriteRule ^/workbox-sw.js$ /content/abbott-platform/scripts/pwa/workbox-6-5-1/workbox-sw.js [PT,L]
				RewriteRule ^/workbox-6-5-1/(.*)$ /content/abbott-platform/scripts/pwa/workbox-6-5-1/$1 [PT,L]
			{{/if}}

			{{#ifEquals name "similac.com"}}
            RewriteRule ^/?$ /home.html [R=302,QSA,L]
            RewriteRule ^/abbott.sw.js$ /content/abbott-platform/scripts/pwa/abbott.sw.js [PT,L]
            RewriteRule ^/workbox-sw.js$ /content/abbott-platform/scripts/pwa/workbox-6-5-1/workbox-sw.js [PT,L]
			RewriteRule ^/workbox-6-5-1/(.*)$ /content/abbott-platform/scripts/pwa/workbox-6-5-1/$1 [PT,L]
            {{/ifEquals}}
            {{#ifNotEquals name "similac.com"}}
			# rewrite for root redirect
			{{#if pagesInHome}}
				{{#if multiMarket}}
			RewriteRule ^/?$ /{{primaryMarket}}/{{primaryLanguage}}/home.html [R=302,QSA,L]
			RewriteRule ^/([^/]+).html$ /$1/{{primaryLanguage}}/home.html [R=302,QSA,L]
			RewriteRule ^/([^/]+)/?$ /$1/{{primaryLanguage}}/home.html [R=302,QSA,L]
			RewriteRule ^/([^/]+)/([^/]+).html$ /$1/$2/home.html [R=302,QSA,L]
			RewriteRule ^/([^/]+)/([^/]+)/?$ /$1/$2/home.html [R=302,QSA,L]
			RewriteRule ^/([^/]+)/([^/]+)/home(\.html)?$ /content/{{division}}/{{site}}/$1/$2/home$3 [PT,L]
				{{else}}
					{{#if multiLanguage}}
			RewriteRule ^/?$ /{{primaryLanguage}}/home.html [R=302,QSA,L]
			RewriteRule ^/([^/]+).html$ /$1/home.html [R=302,QSA,L]
			RewriteRule ^/([^/]+)/?$ /$1/home.html [R=302,QSA,L]
			RewriteRule ^/([^/]+)/home\.html$ /content/{{division}}/{{site}}/{{primaryMarket}}/$1/home.html [PT,L]
					{{else}}
			RewriteRule ^/?$ /home.html [R=302,QSA,L]
			RewriteRule ^/home(\.html)?$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/home$1 [PT,L]
					{{/if}}
				{{/if}}
			{{else}}
				{{#if multiMarket}}
					{{#if homePage}}
			RewriteRule ^/?$ /{{primaryMarket}}/{{primaryLanguage}}/{{homePage}}.html [R=302,QSA,L]
					{{else}}
			RewriteRule ^/?$ /{{primaryMarket}}/{{primaryLanguage}}/home.html [R=302,QSA,L]
					{{/if}}
				{{else}}
					{{#if multiLanguage}}
						{{#if homePage}}
			RewriteRule ^/?$ /{{primaryLanguage}}/{{homePage}}.html [R=302,QSA,L]
						{{else}}
			RewriteRule ^/?$ /{{primaryLanguage}}/home.html [R=302,QSA,L]            
						{{/if}}
					{{else}}
						{{#if homePage}}
			RewriteRule ^/?$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/{{homePage}}.html [PT,L]
						{{else}}
                            {{#if division}}
			RewriteRule ^/?$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/home.html [PT,L]         
                            {{else}}
			RewriteRule ^/?$ /content/{{site}}/{{primaryLanguage}}.html [PT,L]
                            {{/if}}
						{{/if}}
					{{/if}}
				{{/if}}
			{{/if}}
            {{/ifNotEquals}}

			# Rewrite for experience fragments, e.g. when images in xf are referenced
			RewriteCond %{REQUEST_URI} ^/experience-fragment
			RewriteRule ^/(experience-fragment/.*)$ /content/$1 [PT,L]
            
            
            {{#ifEquals name "similac.com"}}
                # Prefix path with content path
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteRule ^/(es|zh)/(.*)$ /content/an/similac/us/$1/$2 [PT,L]
                
                # Prefix path with content path
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteCond %{REQUEST_URI} !^/(es|zh)\.sitemap\.xml
                RewriteRule ^/(.*)$ /content/an/similac/us/en/$1 [PT,L]
                RewriteCond %{REQUEST_URI} ^/(es|zh)\.sitemap\.xml
                RewriteRule ^/(.*)$ /content/an/similac/us/$1 [PT,L]
            {{/ifEquals}}
            
            {{#ifNotEquals name "similac.com"}}
                # Prefix path with content path
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                {{#ifCond isExtensionless '||' isExtensionlessWithoutSlash}}
                RewriteCond %{REQUEST_URI} !\.(gif|jpe?g|png|svg|json|xml|js|webmanifest|map)$
                    {{#if pagesInHome}}
                        {{#if multiMarket}}
                RewriteRule ^/([^/]+)/([^/]+)/(.*)/$ /content/{{division}}/{{site}}/$1/$2/home/$3.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteCond %{REQUEST_URI} !\.(gif|jpe?g|png|svg|json|xml|js|webmanifest|map)$
                RewriteRule ^/([^/]+)/([^/]+)/(.*)$ /content/{{division}}/{{site}}/$1/$2/home/$3.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteRule ^/([^/]+)/([^/]+)/(.*)$ /content/{{division}}/{{site}}/$1/$2/home/$3 [PT,L]
                        {{else}}
                            {{#if multiLanguage}}
                RewriteRule ^/([^/]+)/(.*)/$ /content/{{division}}/{{site}}/{{primaryMarket}}/$1/home/$2.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteCond %{REQUEST_URI} !\.(gif|jpe?g|png|svg|json|xml|js|webmanifest|map)$                
                RewriteRule ^/([^/]+)/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/$1/home/$2.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteRule ^/([^/]+)/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/$1/home/$2 [PT,L]
                            {{else}}
                RewriteRule ^/(.*)/$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/home/$1.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteCond %{REQUEST_URI} !\.(gif|jpe?g|png|svg|json|xml|js|webmanifest|map)$                 
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/home/$1.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/home/$1 [PT,L]
                            {{/if}}
                        {{/if}}
                    {{else}}
                        {{#if multiMarket}}
                RewriteRule ^/(.*)/$ /content/{{division}}/{{site}}/$1.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteCond %{REQUEST_URI} !\.(gif|jpe?g|png|svg|json|xml|js|webmanifest|map)$ 
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/$1.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/$1 [PT,L]
                        {{else}}
                            {{#if multiLanguage}}
                RewriteRule ^/(.*)/$ /content/{{division}}/{{site}}/{{primaryMarket}}/$1.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteCond %{REQUEST_URI} !\.(gif|jpe?g|png|svg|json|xml|js|webmanifest|map)$
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/$1.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/$1 [PT,L]
                            {{else}}
                                {{#if division}}
                RewriteRule ^/(.*)/$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/$1.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteCond %{REQUEST_URI} !\.(gif|jpe?g|png|svg|json|xml|js|webmanifest|map)$
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/$1.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/$1 [PT,L]
                                {{else}}
                RewriteRule ^/(.*)/$ /content/{{site}}/{{primaryLanguage}}/$1.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteCond %{REQUEST_URI} !\.(gif|jpe?g|png|svg|json|xml|js|webmanifest|map)$ 
                RewriteRule ^/(.*)$ /content/{{site}}/{{primaryLanguage}}/$1.html [PT,L]
                RewriteCond %{REQUEST_URI} !^/api
                RewriteCond %{REQUEST_URI} !^/apps
                RewriteCond %{REQUEST_URI} !^/bin
                RewriteCond %{REQUEST_URI} !^/content
                RewriteCond %{REQUEST_URI} !^/crx
                RewriteCond %{REQUEST_URI} !^/etc
                RewriteCond %{REQUEST_URI} !^/libs
                RewriteCond %{REQUEST_URI} !^/saml_login
                RewriteCond %{REQUEST_URI} !^/system
                RewriteCond %{REQUEST_URI} !^/tmp
                RewriteCond %{REQUEST_URI} !^/var
                RewriteCond %{REQUEST_URI} !^/experience-fragment
                RewriteRule ^/(.*)$ /content/{{site}}/{{primaryLanguage}}/$1 [PT,L]
                                {{/if}}
                            {{/if}}
                        {{/if}}
                    {{/if}}
                {{else}}
                    {{#if pagesInHome}}
                        {{#if multiMarket}}
                RewriteRule ^/([^/]+)/([^/]+)/(.*)$ /content/{{division}}/{{site}}/$1/$2/home/$3 [PT,L]
                        {{else}}
                            {{#if multiLanguage}}
                RewriteRule ^/([^/]+)/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/$1/home/$2 [PT,L]
                            {{else}}
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/home/$1 [PT,L]
                            {{/if}}
                        {{/if}}
                    {{else}}
                        {{#if multiMarket}}
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/$1 [PT,L]
                        {{else}}
                            {{#if multiLanguage}}
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/$1 [PT,L]
                            {{else}}
                                {{#if division}}
                RewriteRule ^/(.*)$ /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/$1 [PT,L]         
                                {{else}}
                RewriteRule ^/(.*)$ /content/{{site}}/{{primaryLanguage}}/$1 [PT,L]
                                {{/if}}
                            {{/if}}
                        {{/if}}
                    {{/if}}            
                {{/ifCond}}
            {{/ifNotEquals}}
		{{/if}}
    </IfModule>

    <IfModule mod_headers.c>
		# Include Default Cache Control Headers as Adobe doesn't allow to create any custom file to store them!

		## This is a global file to be included for setting up of Cache-Control Headers for different File Types
        #SetEnvIf Request_URI "(\.min)?\.[a-f0-9]+\.js" long_expires=true
        #SetEnvIf Request_URI "(\.min)?\.[a-f0-9]+\.css" long_expires=true
        #SetEnvIf Request_URI "\.(woff|woff2|eot)" long_expires=true
        
        ## Setting up generic rule first on client for 1 hour and CDN for 1 month
        <LocationMatch "^(?!\/graphql\/execute).*$">
            Header set Cache-Control "max-age=3600, s-maxage=2592000, stale-while-revalidate=30, stale-if-error=60, public"
        </LocationMatch>
        
        <LocationMatch "^/content/.*\.model\.json$">
            Header set Cache-Control "max-age=120,stale-while-revalidate=120" "expr=%{REQUEST_STATUS} < 400"
            Header set Surrogate-Control "stale-while-revalidate=120,stale-if-error=120" "expr=%{REQUEST_STATUS} < 400"
            Header set Age 0
        </LocationMatch>
        
        # Core Component Image Component: long-term caching (30 days) for immutable URLs, background refresh to avoid MISS
        <LocationMatch "^/content/.*\.coreimg.*\.(?i:jpe?g|png|gif|svg)$">
        Header set Cache-Control "max-age=2592000,stale-while-revalidate=43200,stale-if-error=43200,public,immutable" "expr=%{REQUEST_STATUS} < 400"
        Header set Age 0
        </LocationMatch>
        
        {{#ifEquals name "abbott.com"}}    
        ## cache data files by default on the client for 5 min and 7 min on the CDN        
        <LocationMatch "\.(html)$">
            Header set Cache-Control "max-age=300, s-maxage=420, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>
        {{/ifEquals}}
        {{#ifNotEquals name "abbott.com"}}    
        ## cache data files by default on the client for 5 mins and 1 hour on the CDN        
        <LocationMatch "\.(html)$">
            Header set Cache-Control "max-age=300, s-maxage=3600, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>
        {{/ifNotEquals}}
       # Images/Video from DAM: cache mutable resources for max 24h on CDN and background refresh after 1h to avoid MISS
            <LocationMatch "^/content/dam/.*\.(pdf)$">
                Header set Cache-Control "max-age=3600, stale-while-revalidate=43200,stale-if-error=43200" "expr=%{REQUEST_STATUS} < 400"
                Header set Age 0
            </LocationMatch>
		{{#ifEquals name "cms.services.abbott"}}      
        <LocationMatch "^((?!\/graphql\/execute).*)\.(json|xml|txt).*$">
            Header set Cache-Control "max-age=0, s-maxage=120"
			Header set Dispatcher "no-cache"
            Header set Surrogate-Control "max-age=120"
            Header set Age 0
		</LocationMatch>
		{{/ifEquals}}
		{{#ifNotEquals name "cms.services.abbott"}}
        ## cache data files by default on the client for 2 min and 2 min on the CDN
        <LocationMatch "\.(xml|txt)$">
            Header set Cache-Control "max-age=120, s-maxage=120, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>
        ## cache data files by default on the client for 1 hour and 1 hour on the CDN
        <LocationMatch "\.(json)$">
            Header set Cache-Control "max-age=3600, s-maxage=3600, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>
		{{/ifNotEquals}}
		{{#ifEquals name "hellolingo.com"}}
        <LocationMatch "\.(html)$">
            Header set Cache-Control "max-age=1800, s-maxage=3600, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch> 
         {{/ifEquals}}
		{{#ifEquals name "family.abbott"}}
        <LocationMatch "\.(html)$">
            Header set Cache-Control "max-age=300, s-maxage=3600, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch> 
         {{/ifEquals}}         
      {{#ifEquals name "similacproductcheck.com"}}
       <LocationMatch "\.(html)$">
           Header set Cache-Control "max-age=1200, s-maxage=3600, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
		   Header set Age 0
       </LocationMatch>        
       {{/ifEquals}}
        
        ## cache SCRIPTS by default on the client for 30 days/immutable and 1 month on the CDN
        <LocationMatch "^/etc\.clientlibs/.*\.(js|css)$">
            Header set Cache-Control "max-age=2592000, s-maxage=2592000, stale-while-revalidate=7200, stale-if-error=7200, public, immutable" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>

        ## Cache DAM ASSETS on client for 1 month and CDN for 1 year
        <LocationMatch "\.(jpg|jpeg|png|gif|svg|bmp)$">
            Header set Cache-Control "max-age=2592000, s-maxage=31536000, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>

        

        ## Cache FONT files & ICONS on client for 1 year and CDN for 1 month
        <LocationMatch "\.(ico|icon|woff2|woff|eot|font-woff|x-font-woff|ttf|otf)$">
            Header set Cache-Control "max-age=1200, s-maxage=2592000, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>

        ## Cache AUDIO , VIDEO & FLASH files on client for 1 month and CDN for 1 year
        <LocationMatch "\.(ogg|basic|mid|midi|mp3|mp4|webm|3gp|mov|wmv|swf|flv|f4v)$">
            Header set Cache-Control "max-age=2592000, s-maxage=31536000, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>
        
        ## Set lower TTLs for Cybersecurity Product tile images
        <LocationMatch "^\/content\/dam\/bts\/cybersecurity\/us\/en\/images\/product-tile\/.*\.(pdf|jpe?g|png|gif).*">
            Header set Cache-Control "max-age=300, s-maxage=300, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>
        
        {{#ifEquals name "freestylelibre.de"}}
        <LocationMatch "\.(de)\.(json)$">
            Header set Cache-Control "max-age=300, s-maxage=300, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>         
        {{/ifEquals}}
        
        {{#ifEquals name "abbottstore.com"}}
        <LocationMatch "/etc\.clientlibs/abbott/clientlibs/clientlib-abbottstore\.min\.(js|css)$">
            Header set Cache-Control "max-age=300, s-maxage=300, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>         
        {{/ifEquals}}
		
		{{#ifEquals name "glucernastore.com"}}
        <LocationMatch "/etc\.clientlibs/abbott/clientlibs/clientlib-glucerna\.min\.(js|css)$">
            Header set Cache-Control "max-age=300, s-maxage=300, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>         
        {{/ifEquals}}
        {{#ifEquals name "abbottnutrition.com"}}
        <LocationMatch "/abbott\.sw\.(js)$">
            Header set Cache-Control "max-age=300, s-maxage=300, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>         
        {{/ifEquals}}
		
		{{#ifNotEquals name "cybersecurity.abbott"}}
		
         ## adc-secure-redirects page behaviour for caching
        <LocationMatch "^.*\/.*-secure-redirects.html">
			Header set Cache-Control "no-store, max-age=0"
			Header set Dispatcher "no-cache"
		</LocationMatch>
				
        {{/ifNotEquals}}		
       ## Secure behaviour for caching - generic
       <LocationMatch "^.*\/secure\/.*">
			Header set Cache-Control "no-store, max-age=0"
			Header set Dispatcher "no-cache"
		</LocationMatch>  
       
        {{#ifEquals name "cybersecurity.abbott"}}
		## Secure behaviour for caching - testing for cybersecurity
        <LocationMatch "^.*\/secure\/.*">
			Header set Cache-Control "private, max-age=300"
		</LocationMatch>
        {{/ifEquals}}		

       ## Secure behaviour for caching - specific to freestyle ie-en site
        {{#ifEquals name "freestyle.abbott"}}
        <LocationMatch "^.*\/ie-en\/myfreestyle\/secure\/.*">
			Header set Cache-Control "max-age=0, s-maxage=300"
		</LocationMatch>
        {{/ifEquals}}
		

        {{#unless isMapEnabled}}
        ## cache i18n exporter json by default on the client for 5 mins and 5 mins on the CDN - Last match takes preference in LocationMatch, hence, keeping this in  the end.
        <LocationMatch "\.(tagdata)\.(json)$">
            Header set Cache-Control "max-age=300, s-maxage=300, stale-while-revalidate=30, stale-if-error=60, public" "expr=%{REQUEST_STATUS} < 400"
			Header set Age 0
        </LocationMatch>           
		{{/unless}}
        
	</IfModule>

	# Default error-page
    {{#if multiMarket}}
    ErrorDocument 404 /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/errors/404.html
    ErrorDocument 500 /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/errors/500.html
    ErrorDocument 502 /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/errors/500.html
    {{else}}
        {{#if multiLanguage}}
    ErrorDocument 404 /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/errors/404.html
    ErrorDocument 500 /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/errors/500.html
    ErrorDocument 502 /content/{{division}}/{{site}}/{{primaryMarket}}/{{primaryLanguage}}/errors/500.html
        {{else}}
            {{#if division}}
    ErrorDocument 404 /content/{{division}}/{{site}}/{{primaryMarket}}/errors/404.html
    ErrorDocument 500 /content/{{division}}/{{site}}/{{primaryMarket}}/errors/500.html
    ErrorDocument 502 /content/{{division}}/{{site}}/{{primaryMarket}}/errors/500.html
            {{else}}
    ErrorDocument 404 /content/{{site}}/{{primaryLanguage}}/errors/404.html
    ErrorDocument 500 /content/{{site}}/{{primaryLanguage}}/errors/500.html
    ErrorDocument 502 /content/{{site}}/{{primaryLanguage}}/errors/500.html
            {{/if}}
        {{/if}}
    {{/if}}
# Error-page only per market (in order to handle error-page in case language code is missing)
	{{#if division}}
    	{{#if multiMarket}}
        	{{#each markets}}
            	{{#with languages}}
    <LocationMatch "/{{../path}}/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this.[0]}}/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this.[0]}}/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this.[0]}}/errors/500.html
    </LocationMatch>
            	{{/with}}
        	{{/each}}
		{{/if}}
    {{/if}}
	# Error-page per market and language
    {{#if division}}
        {{#if multiMarket}}
        	{{#each markets}}
            	{{#each languages}}
    <LocationMatch "/{{../path}}/{{this}}/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/errors/500.html
    </LocationMatch>
            	{{/each}}
        	{{/each}}
		{{else}}
        	{{#if multiLanguage}}
            	{{#each markets}}
                	{{#each languages}}
    <LocationMatch "/{{this}}/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/errors/500.html
    </LocationMatch>
    {{#ifEquals ../../name "family.abbott"}}
    <LocationMatch "/{{this}}/ensure/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/ensure/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/ensure/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/ensure/errors/500.html
    </LocationMatch>    
    <LocationMatch "/{{this}}/similac/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/similac/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/similac/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/similac/errors/500.html
    </LocationMatch>
    <LocationMatch "/{{this}}/pediasure/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/pediasure/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/pediasure/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/pediasure/errors/500.html
    </LocationMatch>
    <LocationMatch "/{{this}}/glucerna/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/glucerna/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/glucerna/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/glucerna/errors/500.html
    </LocationMatch>
    <LocationMatch "/{{this}}/grow/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/grow/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/grow/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/grow/errors/500.html
    </LocationMatch> 
    <LocationMatch "/{{this}}/nepro/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/nepro/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/nepro/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/nepro/errors/500.html
    </LocationMatch> 
    <LocationMatch "/{{this}}/prosure/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/prosure/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/prosure/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/prosure/errors/500.html
    </LocationMatch> 
    <LocationMatch "/{{this}}/vital/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/vital/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/vital/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/vital/errors/500.html
    </LocationMatch> 
    <LocationMatch "/{{this}}/osmolite/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/osmolite/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/osmolite/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/osmolite/errors/500.html
    </LocationMatch>
    <LocationMatch "/{{this}}/jevity/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/jevity/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/jevity/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/jevity/errors/500.html
    </LocationMatch>   
    <LocationMatch "/{{this}}/simmom/">
        ErrorDocument 404 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/simmom/errors/404.html
        ErrorDocument 500 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/simmom/errors/500.html
        ErrorDocument 502 /content/{{../../division}}/{{../../site}}/{{../path}}/{{this}}/simmom/errors/500.html
    </LocationMatch>          
    
    {{/ifEquals}}
                	{{/each}}
            	{{/each}}
        	{{/if}}
    	{{/if}}
    {{/if}}  
</Virtualhost>
